{"version":3,"sources":["../libs/sdk.js"],"names":["SDK","host","routes","rules","init","key","value","toLowerCase","forEach","method","Object","keys","route","api","url","item"],"mappings":";;;;;;qjBAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AACA;;;;;;AAEA;;;;;;;IAOqBA,G;AACnB,eAAYC,IAAZ,EAAkBC,MAAlB,EAAwC;AAAA,QAAdC,KAAc,uEAAN,IAAM;;AAAA;;AACtC,QAAI,CAACD,MAAD,IAAW,CAACD,IAAhB,EACE;AACF,QAAI,CAAC,sBAASC,MAAT,CAAL,EACE;;AAEF,SAAKD,IAAL,GAAYA,IAAZ;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,KAAL,GAAaA,KAAb;;AAEA,QAAI,KAAKA,KAAT,EACE,KAAKC,IAAL;AACH;;AAED;;;;;;;;;;;;yBAQKC,G,EAAKC,K,EAAO;AACf,UAAI,CAACD,GAAD,IAAQ,CAACC,KAAb,EACE,OAAO,KAAP;AACF,UAAI,CAAC,KAAKH,KAAV,EACE,KAAKA,KAAL,GAAa,EAAb;;AAEF,WAAKA,KAAL,CAAWE,IAAIE,WAAJ,EAAX,IAAgCD,KAAhC;AACA,aAAO,IAAP;AACD;;AAED;;;;;;;;;;2BAOO;AAAA;;AACL,UAAML,OAAO,KAAKA,IAAlB;AACA,UAAME,QAAQ,KAAKA,KAAnB;AACA,UAAMD,SAAS,KAAKA,MAApB;;AAEA;AACA,OAAC,KAAD,EAAQ,MAAR,EAAgB,KAAhB,EAAuB,QAAvB,EAAiCM,OAAjC,CAAyC;AAAA,eACvC,MAAKC,MAAL,IAAe,uBAASR,IAAT,EAAeQ,MAAf,EAAuBN,KAAvB,CADwB;AAAA,OAAzC;;AAGA;AACAO,aAAOC,IAAP,CAAYT,MAAZ,EAAoBM,OAApB,CAA4B,eAAO;AACjC,YAAII,QAAQV,OAAOG,GAAP,CAAZ;AACA,YAAIQ,MAAM;AACRC,eAAK,OAAOF,KAAP,KAAkB,QAAlB,GAA6BA,KAA7B,GAAqCA,MAAME;AADxC,SAAV,CAIC,CAAC,QAAD,EAAW,UAAX,EAAuBN,OAAvB,CAA+B,gBAAQ;AACtC,cAAII,MAAMG,IAAN,CAAJ,EACEF,IAAIE,IAAJ,IAAYH,MAAMG,IAAN,CAAZ;AACH,SAHA;;AAKD,cAAKV,GAAL,IAAY,wBAAUJ,IAAV,EAAgBY,GAAhB,EAAqBV,KAArB,CAAZ;AACD,OAZD;;AAcA,aAAO,IAAP;AACD;;;;;;kBAjEkBH,G","file":"sdk.js","sourcesContent":["//              ____\n//    _________/ / /__\n//   / ___/ __  / //_/\n//  (__  ) /_/ / ,<\n// /____/\\__,_/_/|_|\n//\n// @brief: a sdk factory, build sdks made easy\n// @author: [turingou](http://guoyu.me)\n\nimport isObject from 'lodash.isobject'\nimport { lowLevel, highLevel } from './factory'\n\n/**\n *\n * @host[String]: the host domain\n * @routes[Object]: a object contains every route of the sdk, including its URL, method, and callback function\n * @rules[Object]: a object contains rules which append or merged into query params.\n *\n **/\nexport default class SDK {\n  constructor(host, routes, rules = null) {\n    if (!routes || !host)\n      return\n    if (!isObject(routes))\n      return\n\n    this.host = host\n    this.routes = routes\n    this.rules = rules\n\n    if (this.rules)\n      this.init()\n  }\n\n  /**\n   *\n   * Add a new rule to SDK instance\n   * @key[String]: the key word of this rule, may be `get`,`post` or `all`\n   * @value[Object]: the value of this rule, this very object will be merged in to query params,\n   * for instance, `qs` object will be merged into query string. and `form` object will be merged into post form.\n   *\n   **/\n  rule(key, value) {\n    if (!key || !value)\n      return false\n    if (!this.rules)\n      this.rules = {}\n\n    this.rules[key.toLowerCase()] = value\n    return this\n  }\n\n  /**\n   *\n   * Init a SDK instance\n   * if there's no any available rules provied before ,\n   * this init function can be triggered by users and at any time they want.\n   *\n   **/\n  init() {\n    const host = this.host\n    const rules = this.rules\n    const routes = this.routes;\n\n    // init build-in lowlevel apis\n    ['get', 'post', 'put', 'delete'].forEach(method =>\n      this[method] = lowLevel(host, method, rules))\n\n    // init custom apis\n    Object.keys(routes).forEach(key => {\n      let route = routes[key]\n      let api = {\n        url: typeof(route) === 'string' ? route : route.url\n      }\n\n      ;['method', 'callback'].forEach(item => {\n        if (route[item])\n          api[item] = route[item]\n      })\n\n      this[key] = highLevel(host, api, rules)\n    })\n\n    return this\n  }\n}\n"]}